# Оркестрация и управление pipeline

# =============================================================================
# ОСНОВНОЙ AIRFLOW И ЗАВИСИМОСТИ
# =============================================================================
# Apache Airflow и оркестрация - критически важные компоненты
apache-airflow[statsd]>=2.8.1  	# Основной пакет Airflow
apache-airflow-providers-celery>=3.4.1
apache-airflow-providers-docker>=3.7.0
apache-airflow-providers-http>=4.6.0
apache-airflow-providers-postgres>=5.7.1
celery[redis]>=5.4.0           	# Распределенная обработка задач

# HTTP клиенты и API
requests>=2.31.0               	# HTTP клиент
httpx>=0.27.0                 	# Async HTTP клиент
aiohttp>=3.10.0               	# Async веб-сервер
urllib3>=2.0.0                	# Низкоуровневый HTTP клиент

# JSON обработка - высокопроизводительные парсеры
orjson>=3.10.0                	# Быстрый JSON парсер
ujson>=5.10.0                 	# Ультра быстрый JSON

# Валидация и сериализация данных
pydantic>=2.9.0               	# Валидация данных
marshmallow==3.21.3           	# Сериализация объектов

# Работа с файлами
aiofiles>=23.2.0

# Логирование и мониторинг
structlog>=23.0.0             	# Структурированное логирование
sentry-sdk>=2.17.0            	# Отслеживание ошибок
prometheus-client>=0.21.0     	# Метрики Prometheus
psutil>=6.0.0                 	# Системные метрики
multiprocessing-logging>=0.3.4 	# Логирование в процессах

# База данных - PostgreSQL
SQLAlchemy>=1.4,<2.0.0          # Airflow 2.8.1 требует <2.0.0
alembic>=1.13.0,<2.0          	# Миграции базы данных
psycopg2-binary>=2.9.7        	# Драйвер PostgreSQL

# Работа с временем и датами
pytz>=2024.1                  	# Часовые пояса
python-dateutil>=2.9.0       	# Парсинг и работа с датами

# Конфигурация и переменные окружения
python-dotenv>=1.0.0          	# Загрузка .env файлов
pyyaml>=6.0.0                 	# YAML конфигурация

# Криптография и безопасность
cryptography>=41.0.5,<44      # Криптографические функции
bcrypt>=4.2.0                 # Хеширование паролей

# Тестирование DAG
pytest>=7.4.0
pytest-asyncio>=0.21.0

# Планировщик задач
croniter>=1.4.0

# Клиент для работы с OpenAI-совместимым API (vLLM)
openai>=1.0.0

# Токенизация (для подсчета токенов)
tiktoken>=0.5.0

# Совместимость и стабильность
setuptools>=68.0.0
wheel>=0.41.0
typing-extensions>=4.8.0

# Фиксация проблемных версий (исправление конфликтов зависимостей)
markupsafe>=2.0.1,<3.0.0
jinja2>=3.0.0,<4.0.0
flask>=2.0.0,<3.0.0
werkzeug>=2.0.0,<3.0.0

# Обеспечение совместимости
click>=8.0.0,<9.0.0
rich>=13.0.0

# Интеграция с переводчиком
tqdm>=4.66.0                  # Прогресс-бар для переводчика

# Утилиты и вспомогательные библиотеки
regex>=2023.8.8               # Расширенная поддержка регулярных выражений
attrs>=24.2.0                 # Упрощение создания классов
retry>=0.9.0                  # Простая retry логика

# Работа с файловой системой
watchdog>=5.0.0               # Мониторинг изменений файлов

# Работа с офисными файлами
python-docx>=0.8.11           # Работа с Word документами
python-pptx>=1.0.0            # Работа с PowerPoint
tabula-py>=2.9.0              # Извлечение таблиц из PDF
tabulate>=0.9.0               # Форматирование таблиц

# NLP и обработка китайского текста - критически важно
nltk>=3.9.0                   # Natural Language Processing
spacy>=3.8.0                  # Продвинутый NLP
jieba>=0.42.0                 # Сегментация китайского текста - КРИТИЧЕСКИ ВАЖНО
beautifulsoup4>=4.12.0        # Парсинг HTML/XML
lxml>=5.3.0                   # Быстрый XML парсер
chardet>=5.2.0                # Определение кодировки
ftfy>=6.1.0                   # Исправление поврежденного текста

# Обработка данных
pandas>=2.0.0                  # Анализ данных
numpy>=1.24.0                  # Численные вычисления (убрано верхнее ограничение)
openpyxl>=3.1.0               # Работа с Excel
xlsxwriter>=3.2.0             # Запись Excel файлов

# Обработка изображений и OCR
Pillow>=10.0.0                 # Обработка изображений
opencv-python>=4.8.0           # Заменяет opencv-python-headless - полная версия с GUI
pytesseract>=0.3.10           # OCR функциональность
Wand>=0.6.0                   # ImageMagick интеграция

connexion[swagger-ui]==2.14.2    # Swagger UI для Airflow REST API
flask-limiter[redis]==3.5.0     # Хранение rate limits в Redis